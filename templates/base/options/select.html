{{ define "main"}}{{if .label}}<label{{ if .labelClasses }} class="{{range .labelClasses}}{{.}} {{end}}"{{end}}{{if .id}} for="{{.id}}"{{end}}>{{.label}}</label>{{end}}
<select name="{{.name}}"{{ if .classes }} class="{{range .classes}}{{.}} {{end}}"{{end}}{{if .id}} id="{{.id}}"{{end}}{{if .params}}{{range $k, $v := .params}} {{$k}}="{{$v}}"{{end}}{{end}}{{if .css}} style="{{range $k, $v := .css}}{{$k}}: {{$v}}; {{end}}"{{end}}{{range $k,$v := .tags}} {{$k}}{{end}}>{{ $p := . }}{{range $k, $v := .choices}}
{{ if $k }}<optgroup label="{{$k}}">{{end}}{{range $v}}
<option value="{{.Id}}"{{if $p.tags.multiple }}{{if .Checked}} selected="selected"{{end}}{{else}}{{if or .Checked (eq $p.value .Id)}} selected="selected"{{end}}{{end}}>{{.Val}}</option>{{end}}
{{if $k}}</optgroup>{{end}}{{end}}
</select>
{{end}}